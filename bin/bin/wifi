#!/bin/sh
pkill wpa_supplicant
pkill dhcpcd

DEV=`ip link | cut -d' ' -f 2 | cut -d':' -f 1 | grep -v '^$' | grep enp`
DEV="wlp4s0b1"
echo "Using $DEV"

function doconnect() {
    ip link set $DEV up
    iwlist $DEV scan | grep -B 1 "ESSID:"

    wpa_supplicant -B -Dwext -i $DEV -c /etc/wpa_supplicant/wpa_supplicant.conf
    sleep 2
    dhcpcd $DEV
}

case $1 in
    connect)
        doconnect
        ;;
esac

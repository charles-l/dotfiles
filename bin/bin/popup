#!/bin/sh
#
# z3bra - (c) wtfpl 2014
# Create a small popup with the given text
#
# depends: lemonbar, wattr and common sense

# bar options
#font='-*-stlarch-medium-r-*-*-10-*-*-*-*-*-*-*'
font="-*-creep-*-*-*--16-*-*-*-*-*-*-1"
iconfont="-*-siji-*-*-*--*-*-*-*-*-*-*-1"
bg="#CCC"
fg="#333"
hl="#ff443232"

default_geometry() {
    # get screen size
    x=$(wattr w `lsw -r`)
    y=$(wattr h `lsw -r`)

    width=500
    height=20

    offy=$((y - $height))
    offx=200
    #offx=$(( x - x/2 - $width/2 ))
    #offx=$(( x - $width - $offy))

    echo "${width}x${height}+${offx}+${offy}"
}

while getopts "d:g:h" opt; do
    case $opt in
        d) SLEEP=$OPTARG ;;
        g) GEOM=$OPTARG  ;;
        h) usage; exit 0 ;;
    esac
done

GEOM=${GEOM:-$(default_geometry)}
SLEEP=${SLEEP:-3}

if [ -t 0 ]; then
    (echo "%{c}$@"; sleep $SLEEP) | lemonbar -d -g $GEOM -B $bg -F $fg -f $iconfont
else
    (echo "%{c}$@ $(cat)"; sleep $SLEEP) | lemonbar -d -g $GEOM -B $bg -F $fg -f $font -f $iconfont
fi

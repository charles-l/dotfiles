#!/bin/sh
# my bar!
#
# deps:
#  - wmutils
#  - github.com/charles-l/bin
#  - bspwm
#  - lemonbar
#
# charlie - (c) 2015

default_geometry() {
    # get screen size
    x=$(wattr w `lsw -r`)
    y=$(wattr h `lsw -r`)

    width=500
    height=20

    offy=0
    offx=$(( x - x/2 - $width/2 ))

    echo "${width}x${height}+${offx}+${offy}"
}

while true
do
    VOL=`progbar $(volume | sed -e 's/%.*$//')`
    CUR_SONG=`cursong`
    # CUR_DESKTOP=`bspc control --get-status | tr -d 'WLT:mM0-9=' | sed -e 's/[of]//g' | sed -e 's/[OF]//g'`
    [ -z "$CUR_SONG" ] && MID="$CUR_DESKTOP" || MID="  $CUR_SONG"
    TIME=`date "+%H:%M"`
    echo "  $VOL %{c} $MID" "%{r}$TIME "
done | lemonbar -g -d `default_geometry` \
    -f "-*-creep-*-*-*--*-*-*-*-*-*-*-*" -f "-*-siji-*-*-*--*-*-*-*-*-*-*-*"

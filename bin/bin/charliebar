#!/bin/sh
# my bar!
#
# deps:
#  - lemonbar
#
# charlie - (c) 2015

default_geometry() {
    # get screen size
    x=$(wattr w `lsw -r`)
    y=$(wattr h `lsw -r`)

    width=200
    height=20

    offy=$(($y - $height))
    #offx=$(( x - x/2 - $width/2 ))
    offx=0

    echo "${width}x${height}+${offx}+${offy}"
}

lemoncommand() {
    lemonbar -d -g `default_geometry` -B '#000' -F'#333' \
        -f "-*-creep-*-*-*--*-*-*-*-*-*-*-*" -f "-*-siji-*-*-*--*-*-*-*-*-*-*-*"
}

while true
do
    MC=`ls mail/inbox/new/ | wc -l`
    FEEDS=`newsbeuter -x print-unread | head -n1 | cut -d' ' -f1`
    TIME=`date "+%H:%M %-m/%-d"`
    echo " %{c}$TIME  $MC  $FEEDS"
    sleep 60
done | lemoncommand
